"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[368],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return y}});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var u=r.createContext({}),d=function(e){var t=r.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=d(e.components);return r.createElement(u.Provider,{value:t},e.children)},c="mdxType",s={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,u=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=d(a),m=n,y=c["".concat(u,".").concat(m)]||c[m]||s[m]||o;return a?r.createElement(y,l(l({ref:t},p),{},{components:a})):r.createElement(y,l({ref:t},p))}));function y(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,l=new Array(o);l[0]=m;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i[c]="string"==typeof e?e:n,l[1]=i;for(var d=2;d<o;d++)l[d]=a[d];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},4688:function(e,t,a){a.r(t),a.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return s},frontMatter:function(){return o},metadata:function(){return i},toc:function(){return d}});var r=a(3117),n=(a(7294),a(3905));const o={sidebar_position:2,id:"use-lazy-load-query",title:"useLazyLoadQuery",description:"API reference for useLazyLoadQuery, a React hook used to lazily fetch query data when a component renders",keywords:["lazy fetching","query","fetch"]},l=void 0,i={unversionedId:"apollo-react-relay-duct-tape/use-lazy-load-query",id:"apollo-react-relay-duct-tape/use-lazy-load-query",title:"useLazyLoadQuery",description:"API reference for useLazyLoadQuery, a React hook used to lazily fetch query data when a component renders",source:"@site/docs/apollo-react-relay-duct-tape/use-lazy-load-query.md",sourceDirName:"apollo-react-relay-duct-tape",slug:"/apollo-react-relay-duct-tape/use-lazy-load-query",permalink:"/graphitation/docs/apollo-react-relay-duct-tape/use-lazy-load-query",draft:!1,editUrl:"https://github.com/microsoft/graphitation/tree/main/website/docs/apollo-react-relay-duct-tape/use-lazy-load-query.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,id:"use-lazy-load-query",title:"useLazyLoadQuery",description:"API reference for useLazyLoadQuery, a React hook used to lazily fetch query data when a component renders",keywords:["lazy fetching","query","fetch"]},sidebar:"tutorialSidebar",previous:{title:"Intro",permalink:"/graphitation/docs/apollo-react-relay-duct-tape/intro"},next:{title:"useFragment",permalink:"/graphitation/docs/apollo-react-relay-duct-tape/use-fragment"}},u={},d=[{value:"<code>useLazyLoadQuery</code>",id:"uselazyloadquery",level:2},{value:"Arguments",id:"arguments",level:3},{value:"TypeScript Parameters",id:"typescript-parameters",level:3},{value:"Return Value",id:"return-value",level:3},{value:"Behavior",id:"behavior",level:3}],p={toc:d},c="wrapper";function s(e){let{components:t,...a}=e;return(0,n.kt)(c,(0,r.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"uselazyloadquery"},(0,n.kt)("inlineCode",{parentName:"h2"},"useLazyLoadQuery")),(0,n.kt)("p",null,"Hook used to fetch a GraphQL query during render. This hook can trigger multiple nested or waterfalling round trips if used without caution, and waits until render to start a data fetch."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-tsx"},'import React from "react";\nimport {\n  graphql,\n  useLazyLoadQuery,\n} from "@graphitation/apollo-react-relay-duct-tape";\n\nimport { AppQuery } from "./__generated__/AppQuery.graphql";\n\nconst App: React.FC = {\n  const { data, error } = useLazyLoadQuery<AppQuery>(\n    graphql`\n      query AppQuery($id: ID!) {\n        user(id: $id) {\n          name\n        }\n      }\n    `,\n    { id: 4 },\n    { fetchPolicy: "store-or-network" }\n  );\n\n  if (error) {\n    return <div>{error.message}</div>;\n  } else if (data) {\n    return <div>{data.user?.name} is great!</div>;\n  }\n  return <div>Loading</div>;\n}\n')),(0,n.kt)("h3",{id:"arguments"},"Arguments"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"query"),": GraphQL query specified using a ",(0,n.kt)("inlineCode",{parentName:"li"},"graphql")," template literal."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"variables"),": Object containing the variable values to fetch the query. These variables need to match GraphQL variables declared inside the query."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"options"),": ",(0,n.kt)("em",{parentName:"li"},(0,n.kt)("em",{parentName:"em"},"[Optional]"))," options object",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"fetchPolicy"),": Determines if cached data should be used, and when to send a network request based on the cached data that is currently available in the store (for more details, see our ",(0,n.kt)("a",{parentName:"li",href:"../../guided-tour/reusing-cached-data/fetch-policies"},"Fetch Policies"),":",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},'"store-or-network": ',(0,n.kt)("em",{parentName:"li"},(0,n.kt)("em",{parentName:"em"},"(default)"))," ",(0,n.kt)("em",{parentName:"li"},"will")," reuse locally cached data and will ",(0,n.kt)("em",{parentName:"li"},"only")," send a network request if any data for the query is missing. If the query is fully cached, a network request will ",(0,n.kt)("em",{parentName:"li"},"not")," be made."),(0,n.kt)("li",{parentName:"ul"},'"store-and-network": ',(0,n.kt)("em",{parentName:"li"},"will")," reuse locally cached data and will ",(0,n.kt)("em",{parentName:"li"},"always")," send a network request, regardless of whether any data was missing from the local cache or not."),(0,n.kt)("li",{parentName:"ul"},'"network-only": ',(0,n.kt)("em",{parentName:"li"},"will")," ",(0,n.kt)("em",{parentName:"li"},"not")," reuse locally cached data, and will ",(0,n.kt)("em",{parentName:"li"},"always")," send a network request to fetch the query, ignoring any data that might be locally cached."),(0,n.kt)("li",{parentName:"ul"},'"store-only": ',(0,n.kt)("em",{parentName:"li"},"will")," ",(0,n.kt)("em",{parentName:"li"},"only")," reuse locally cached data, and will ",(0,n.kt)("em",{parentName:"li"},"never")," send a network request to fetch the query. In this case, the responsibility of fetching the query falls to the caller, but this policy could also be used to read and operate on data that is entirely ",(0,n.kt)("a",{parentName:"li",href:"../../guided-tour/updating-data/local-data-updates"},"local"),".")))))),(0,n.kt)("h3",{id:"typescript-parameters"},"TypeScript Parameters"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"TQuery"),": Type parameter that should correspond to the TypeScript type for the specified query. This type is available to import from the auto-generated file: ",(0,n.kt)("inlineCode",{parentName:"li"},"<query_name>.graphql.ts"),".")),(0,n.kt)("h3",{id:"return-value"},"Return Value"),(0,n.kt)("p",null,"Object containing the following properties:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"data"),": Object that contains data which has been read out from the store; the object matches the shape of the specified query.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"The TypeScript type for data will also match this shape, and contain types derived from the GraphQL Schema. For example, the type of ",(0,n.kt)("inlineCode",{parentName:"li"},"data")," above is: ",(0,n.kt)("inlineCode",{parentName:"li"},"{ user: { name: string } }"),".")))),(0,n.kt)("h3",{id:"behavior"},"Behavior"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"It is expected for ",(0,n.kt)("inlineCode",{parentName:"li"},"useLazyLoadQuery")," to have been rendered under a ",(0,n.kt)("a",{parentName:"li",href:"https://www.apollographql.com/docs/react/api/react/hooks/#the-apolloprovider-component"},(0,n.kt)("inlineCode",{parentName:"a"},"ApolloProvider")),", in order to access the correct Apollo Client environment, otherwise an error will be thrown."),(0,n.kt)("li",{parentName:"ul"},"The component is automatically subscribed to updates to the query data: if the data for this query is updated anywhere in the app, the component will automatically re-render with the latest updated data."),(0,n.kt)("li",{parentName:"ul"},"After a component using ",(0,n.kt)("inlineCode",{parentName:"li"},"useLazyLoadQuery")," has committed, re-rendering/updating the component will not cause the query to be fetched again.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"If the component is re-rendered with ",(0,n.kt)("em",{parentName:"li"},"different query variables,")," that will cause the query to be fetched again with the new variables, and potentially re-render with different data."),(0,n.kt)("li",{parentName:"ul"},"If the component ",(0,n.kt)("em",{parentName:"li"},"unmounts and remounts"),", that will cause the current query and variables to be refetched (depending on the ",(0,n.kt)("inlineCode",{parentName:"li"},"fetchPolicy")," and the state of the store).")))))}s.isMDXComponent=!0}}]);